{"ast":null,"code":"var _jsxFileName = \"E:\\\\socket stories\\\\frontend\\\\src\\\\Pages\\\\PostPage.js\",\n    _s = $RefreshSig$();\n\nimport React, { useContext, useEffect, useState } from \"react\";\nimport { Col, Container, Row, Card } from \"react-bootstrap\";\nimport NewCommentForm from \"../Components/Forms/NewCommentForm\";\nimport CommentsList from \"../Components/CommentsList\";\nimport PostUpdateForm from \"../Components/Forms/PostUpdateForm\";\nimport Loading from \"../Components/Loading\";\nimport { deletePost, getPostById, updatePost } from \"../lib/api\";\nimport { useNavigate, useParams } from \"react-router-dom\";\nimport Banner from \"../Components/Banner\";\nimport AuthContext from \"../store/auth-context\";\nimport { useTranslation } from \"react-i18next\";\nimport \"./PostPages.css\"; // Import the custom CSS file\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst PostPage = props => {\n  _s();\n\n  const [post, setPost] = useState({});\n  const [comments, setComments] = useState([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [isPostUpdated, setIsPostUpdated] = useState(false);\n  const [isPostDeleted, setIsPostDeleted] = useState(false);\n  const [isDeletingPost, setIsDeletingPost] = useState(false);\n  const [error, setError] = useState(null);\n  const {\n    id\n  } = useParams();\n  const authCtx = useContext(AuthContext);\n  const navigate = useNavigate();\n  const {\n    t\n  } = useTranslation();\n\n  const onPostUpdate = (updatedContent, formikHelpers) => {\n    updatePost({\n      id: post.id,\n      content: updatedContent.content\n    }, authCtx.token).then(() => {\n      setIsPostUpdated(true);\n    }).catch(error => {\n      console.log(error);\n    }).finally(() => {\n      formikHelpers.setSubmitting(false);\n    });\n  };\n\n  const onPostDelete = () => {\n    setIsDeletingPost(true);\n    deletePost(post.id, authCtx.token).then(() => {\n      setIsPostDeleted(true);\n    }).catch(error => {\n      console.log(error);\n    }).finally(() => {\n      setIsDeletingPost(false);\n    });\n  };\n\n  const fetchPostById = () => {\n    setIsLoading(true);\n    getPostById(id).then(post => {\n      setPost(post);\n      setComments(post.comments);\n    }).catch(error => {\n      setError(error.message);\n    }).finally(() => {\n      setIsLoading(false);\n    });\n  };\n\n  useEffect(() => {\n    fetchPostById();\n  }, []);\n  useEffect(() => {\n    if (isPostUpdated) {\n      setTimeout(() => {\n        setIsPostUpdated(false);\n        fetchPostById();\n      }, 1000);\n    }\n\n    if (isPostDeleted) {\n      setTimeout(() => {\n        setIsPostDeleted(false);\n        navigate(\"/\");\n      }, 1000);\n    }\n  }, [isPostUpdated, isPostDeleted]);\n\n  let content = /*#__PURE__*/_jsxDEV(Loading, {}, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 88,\n    columnNumber: 17\n  }, this);\n\n  if (error) {\n    content = /*#__PURE__*/_jsxDEV(Banner, {\n      className: \"banner error-banner\",\n      message: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 7\n    }, this);\n  } else if (!isLoading) {\n    content = /*#__PURE__*/_jsxDEV(Col, {\n      className: \"d-flex flex-column align-items-center\",\n      children: [/*#__PURE__*/_jsxDEV(Card, {\n        className: \"mb-4 p-4 card\",\n        children: [/*#__PURE__*/_jsxDEV(PostUpdateForm, {\n          className: \"post-update-form\",\n          onSubmit: onPostUpdate,\n          onPostDelete: onPostDelete,\n          isDeletingPost: isDeletingPost,\n          isPostDeleted: isPostDeleted,\n          post: post\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 11\n        }, this), isPostUpdated && /*#__PURE__*/_jsxDEV(Banner, {\n          className: \"banner success-banner mt-3\",\n          message: `${t(\"updatedBy\", {\n            type: \"post\"\n          })} ${authCtx.userName}`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 13\n        }, this), isPostDeleted && /*#__PURE__*/_jsxDEV(Banner, {\n          className: \"banner error-banner mt-3\",\n          message: `${t(\"deleteBy\", {\n            type: \"post\"\n          })} ${authCtx.userName}`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 9\n      }, this), (authCtx.isLoggedIn || comments.length > 0) && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"comments-header\",\n        children: t(\"comments\")\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 11\n      }, this), authCtx.isLoggedIn && /*#__PURE__*/_jsxDEV(NewCommentForm, {\n        onContentChange: fetchPostById,\n        postId: post.id\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(CommentsList, {\n        onContentChange: fetchPostById,\n        comments: comments\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 7\n    }, this);\n  }\n\n  return /*#__PURE__*/_jsxDEV(Container, {\n    children: /*#__PURE__*/_jsxDEV(Row, {\n      className: \"pt-4 justify-content-center\",\n      children: content\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 127,\n    columnNumber: 5\n  }, this);\n};\n\n_s(PostPage, \"ka3U+vAoPkFYYvgXMM+M9H1Duis=\", false, function () {\n  return [useParams, useNavigate, useTranslation];\n});\n\n_c = PostPage;\nexport default PostPage;\n\nvar _c;\n\n$RefreshReg$(_c, \"PostPage\");","map":{"version":3,"names":["React","useContext","useEffect","useState","Col","Container","Row","Card","NewCommentForm","CommentsList","PostUpdateForm","Loading","deletePost","getPostById","updatePost","useNavigate","useParams","Banner","AuthContext","useTranslation","PostPage","props","post","setPost","comments","setComments","isLoading","setIsLoading","isPostUpdated","setIsPostUpdated","isPostDeleted","setIsPostDeleted","isDeletingPost","setIsDeletingPost","error","setError","id","authCtx","navigate","t","onPostUpdate","updatedContent","formikHelpers","content","token","then","catch","console","log","finally","setSubmitting","onPostDelete","fetchPostById","message","setTimeout","type","userName","isLoggedIn","length"],"sources":["E:/socket stories/frontend/src/Pages/PostPage.js"],"sourcesContent":["import React, { useContext, useEffect, useState } from \"react\";\r\nimport { Col, Container, Row, Card } from \"react-bootstrap\";\r\nimport NewCommentForm from \"../Components/Forms/NewCommentForm\";\r\nimport CommentsList from \"../Components/CommentsList\";\r\nimport PostUpdateForm from \"../Components/Forms/PostUpdateForm\";\r\nimport Loading from \"../Components/Loading\";\r\nimport { deletePost, getPostById, updatePost } from \"../lib/api\";\r\nimport { useNavigate, useParams } from \"react-router-dom\";\r\nimport Banner from \"../Components/Banner\";\r\nimport AuthContext from \"../store/auth-context\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport \"./PostPages.css\"; // Import the custom CSS file\r\n\r\nconst PostPage = (props) => {\r\n  const [post, setPost] = useState({});\r\n  const [comments, setComments] = useState([]);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [isPostUpdated, setIsPostUpdated] = useState(false);\r\n  const [isPostDeleted, setIsPostDeleted] = useState(false);\r\n  const [isDeletingPost, setIsDeletingPost] = useState(false);\r\n  const [error, setError] = useState(null);\r\n  const { id } = useParams();\r\n  const authCtx = useContext(AuthContext);\r\n  const navigate = useNavigate();\r\n  const { t } = useTranslation();\r\n\r\n  const onPostUpdate = (updatedContent, formikHelpers) => {\r\n    updatePost({ id: post.id, content: updatedContent.content }, authCtx.token)\r\n      .then(() => {\r\n        setIsPostUpdated(true);\r\n      })\r\n      .catch((error) => {\r\n        console.log(error);\r\n      })\r\n      .finally(() => {\r\n        formikHelpers.setSubmitting(false);\r\n      });\r\n  };\r\n\r\n  const onPostDelete = () => {\r\n    setIsDeletingPost(true);\r\n    deletePost(post.id, authCtx.token)\r\n      .then(() => {\r\n        setIsPostDeleted(true);\r\n      })\r\n      .catch((error) => {\r\n        console.log(error);\r\n      })\r\n      .finally(() => {\r\n        setIsDeletingPost(false);\r\n      });\r\n  };\r\n\r\n  const fetchPostById = () => {\r\n    setIsLoading(true);\r\n    getPostById(id)\r\n      .then((post) => {\r\n        setPost(post);\r\n        setComments(post.comments);\r\n      })\r\n      .catch((error) => {\r\n        setError(error.message);\r\n      })\r\n      .finally(() => {\r\n        setIsLoading(false);\r\n      });\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchPostById();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (isPostUpdated) {\r\n      setTimeout(() => {\r\n        setIsPostUpdated(false);\r\n        fetchPostById();\r\n      }, 1000);\r\n    }\r\n    if (isPostDeleted) {\r\n      setTimeout(() => {\r\n        setIsPostDeleted(false);\r\n        navigate(\"/\");\r\n      }, 1000);\r\n    }\r\n  }, [isPostUpdated, isPostDeleted]);\r\n\r\n  let content = <Loading />;\r\n\r\n  if (error) {\r\n    content = (\r\n      <Banner className=\"banner error-banner\" message={error} />\r\n    );\r\n  } else if (!isLoading) {\r\n    content = (\r\n      <Col className=\"d-flex flex-column align-items-center\">\r\n        <Card className=\"mb-4 p-4 card\">\r\n          <PostUpdateForm\r\n            className=\"post-update-form\"\r\n            onSubmit={onPostUpdate}\r\n            onPostDelete={onPostDelete}\r\n            isDeletingPost={isDeletingPost}\r\n            isPostDeleted={isPostDeleted}\r\n            post={post}\r\n          />\r\n          {isPostUpdated && (\r\n            <Banner className=\"banner success-banner mt-3\" message={`${t(\"updatedBy\", { type: \"post\" })} ${authCtx.userName}`} />\r\n          )}\r\n          {isPostDeleted && (\r\n            <Banner className=\"banner error-banner mt-3\" message={`${t(\"deleteBy\", { type: \"post\" })} ${authCtx.userName}`} />\r\n          )}\r\n        </Card>\r\n\r\n        {(authCtx.isLoggedIn || comments.length > 0) && (\r\n          <div className=\"comments-header\">{t(\"comments\")}</div>\r\n        )}\r\n\r\n        {authCtx.isLoggedIn && (\r\n          <NewCommentForm onContentChange={fetchPostById} postId={post.id} />\r\n        )}\r\n        <CommentsList onContentChange={fetchPostById} comments={comments} />\r\n      </Col>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Container>\r\n      <Row className=\"pt-4 justify-content-center\">\r\n        {content}\r\n      </Row>\r\n    </Container>\r\n  );\r\n};\r\n\r\nexport default PostPage;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}